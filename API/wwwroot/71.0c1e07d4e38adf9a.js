"use strict";(self.webpackChunkcourse_ui=self.webpackChunkcourse_ui||[]).push([[71],{9071:(V,p,s)=>{s.r(p),s.d(p,{ViewMessagesComponent:()=>h,ViewMessagesModule:()=>F});var x=s(8645),M=s(9773),e=s(5879),C=s(9280),g=s(6814),l=s(95),u=s(2236),d=s(7282),m=s(7012),_=s(285),f=s(2761);function b(t,a){1&t&&e._UZ(0,"app-util-loader")}function Z(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",7),e.NdJ("ngModelChange",function(i){e.CHM(n);const c=e.oxw();return e.KtG(c.container=i)})("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.load())}),e._UZ(1,"i",8),e._uU(2),e.qZA()}if(2&t){const n=a.$implicit,o=e.oxw();e.Q6J("btnRadio",n.value)("ngModel",o.container)("disabled",o.container===n.value),e.xp6(1),e.Q6J("ngClass","fa-"+n.icon),e.xp6(1),e.hij(" ",n.display," ")}}function T(t,a){1&t&&(e.TgZ(0,"h4",10),e._uU(1,"There are no messages to display in this folder"),e.qZA())}function w(t,a){if(1&t&&(e.YNc(0,T,2,0,"h4",9),e.ALo(1,"async")),2&t){const n=e.oxw();e.Q6J("ngIf",!e.lcZ(1,1,n.loading$))}}function y(t,a){1&t&&(e.ynx(0),e.TgZ(1,"th",14),e._uU(2,"From"),e.qZA(),e.TgZ(3,"th",14),e._uU(4,"Sent"),e.qZA(),e.BQk())}function v(t,a){1&t&&(e.TgZ(0,"th",14),e._uU(1,"To"),e.qZA(),e.TgZ(2,"th",14),e._uU(3,"Received"),e.qZA())}const A=function(){return{tab:"Messages"}};function U(t,a){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"tr",18)(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._UZ(5,"img",19),e.TgZ(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"timeago"),e.qZA(),e.TgZ(11,"td")(12,"button",20),e.NdJ("click",function(i){e.CHM(n);const c=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.deleteMessage(i,c))}),e._uU(13," Delete "),e.qZA()()(),e.BQk()}if(2&t){const n=a.ngIf,o=e.oxw().$implicit;e.xp6(1),e.MGl("routerLink","/members/",n.username,""),e.Q6J("queryParams",e.DdM(9,A)),e.xp6(2),e.Oqu(o.content),e.xp6(2),e.Q6J("src",n.photoUrl||"assets/default-member-photo.png",e.LSH)("alt",n.username+" photo"),e.xp6(2),e.Oqu(n.username),e.xp6(2),e.hij(" ",e.lcZ(10,7,o.messageSent)," ")}}function I(t,a){if(1&t&&(e.ynx(0),e.YNc(1,U,14,10,"ng-container",0),e.BQk()),2&t){const n=a.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.getMessageUser(n))}}function O(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",21)(1,"pagination",22),e.NdJ("ngModelChange",function(i){e.CHM(n);const c=e.oxw(2);return e.KtG(c.pageNumber=i)})("pageChanged",function(i){e.CHM(n);const c=e.oxw(2);return e.KtG(c.pageChanged(i))}),e.qZA()()}if(2&t){const n=a.ngIf,o=e.oxw(2);e.xp6(1),e.Q6J("boundaryLinks",!0)("totalItems",n.totalItems)("itemsPerPage",n.itemsPerPage)("maxSize",10)("disabled",n.totalPages<2)("ngModel",o.pageNumber)}}function $(t,a){if(1&t&&(e.ynx(0),e.TgZ(1,"table",11)(2,"thead")(3,"tr")(4,"th",12),e._uU(5,"Message"),e.qZA(),e.YNc(6,y,5,0,"ng-container",6),e.YNc(7,v,4,0,"ng-template",null,13,e.W1O),e._UZ(9,"th",14),e.qZA()(),e.TgZ(10,"tbody",15),e.YNc(11,I,2,1,"ng-container",16),e.ALo(12,"async"),e.qZA()(),e.YNc(13,O,2,6,"div",17),e.ALo(14,"async"),e.BQk()),2&t){const n=e.MAs(8),o=e.oxw();e.xp6(6),e.Q6J("ngIf","Outbox"!==o.container)("ngIfElse",n),e.xp6(5),e.Q6J("ngForOf",e.lcZ(12,4,o.messages$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,6,o.pagination$))}}let h=(()=>{class t{constructor(n){this.userFacade=n,this.loading$=this.userFacade.loading$,this.messages$=this.userFacade.messages$,this.pagination$=this.userFacade.messagesPagination$,this.pageNumber=1,this.container="Unread",this.containerOpt=[{value:"Unread",display:"Unread",icon:"envelope"},{value:"Inbox",display:"Inbox",icon:"envelope-open"},{value:"Outbox",display:"Outbox",icon:"paper-plane"}],this.destroy$=new x.x}ngOnInit(){this.pagination$.pipe((0,M.R)(this.destroy$)).subscribe(n=>this.pageNumber=n.currentPage),this.load()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}load(){this.userFacade.loadUserMessages(this.container)}pageChanged(n){n.page!==this.pageNumber&&this.userFacade.goToUserMessagesPage(n.page,this.container)}getMessageUser(n){return"Outbox"===this.container?n.recipient:n.sender}deleteMessage(n,o){n.stopPropagation(),this.userFacade.deleteMessage(o)}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(C.K))};static#n=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-view-messages"]],decls:10,vars:8,consts:[[4,"ngIf"],[1,"container","d-flex","flex-column","gap-5"],[1,"d-flex","justify-content-center"],["name","container",1,"btn-group"],["class","btn btn-primary",3,"btnRadio","ngModel","disabled","ngModelChange","click",4,"ngFor","ngForOf"],["noMessages",""],[4,"ngIf","ngIfElse"],[1,"btn","btn-primary",3,"btnRadio","ngModel","disabled","ngModelChange","click"],[1,"fa","me-2",3,"ngClass"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"table","table-hover","cursor-pointer"],[1,"w-40"],["outboxTh",""],[1,"w-20"],[1,"align-middle"],[4,"ngFor","ngForOf"],["class","w-100 d-flex justify-content-center",4,"ngIf"],[3,"routerLink","queryParams"],[1,"profile-pic","img-circle","rounded-circle","me-2",3,"src","alt"],[1,"btn","btn-danger",3,"click"],[1,"w-100","d-flex","justify-content-center"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"boundaryLinks","totalItems","itemsPerPage","maxSize","disabled","ngModel","ngModelChange","pageChanged"]],template:function(o,i){if(1&o&&(e.YNc(0,b,1,0,"app-util-loader",0),e.ALo(1,"async"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3),e.YNc(5,Z,3,5,"button",4),e.qZA()(),e.YNc(6,w,2,3,"ng-template",null,5,e.W1O),e.YNc(8,$,15,8,"ng-container",6),e.ALo(9,"async"),e.qZA()),2&o){const c=e.MAs(7);let r;e.Q6J("ngIf",e.lcZ(1,4,i.loading$)),e.xp6(5),e.Q6J("ngForOf",i.containerOpt),e.xp6(3),e.Q6J("ngIf",null==(r=e.lcZ(9,6,i.messages$))?null:r.length)("ngIfElse",c)}},dependencies:[g.mk,g.sg,g.O5,l.JJ,l.On,u.rH,d.lz,m.Qt,_.I,g.Ov,f.wr],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.w-40[_ngcontent-%COMP%]{width:40%}.w-20[_ngcontent-%COMP%]{width:20%}.profile-pic[_ngcontent-%COMP%]{width:50px;height:50px}"]})}return t})(),F=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#n=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[g.ez,l.u5,u.Bz.forChild([{path:"",component:h}]),d.Fq.forRoot(),m.u3.forRoot(),f.$L.forRoot(),_.I]})}return t})()}}]);